<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VeggiPlan: Vegetarian Meal Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc; /* Tailwind gray-100 */
        }
        /* Style for the element being dragged */
        .dragging {
            opacity: 0.5;
            border: 2px dashed #fbbf24; /* Tailwind amber-400 */
        }
        /* Style for the drop zone when dragging over it */
        .drag-over {
            background-color: #fef3c7; /* Tailwind amber-100 */
            transform: scale(1.02);
            transition: transform 0.2s, background-color 0.2s;
        }
        /* Hide the scrollbar but keep it scrollable */
        #recipe-list::-webkit-scrollbar {
            width: 8px;
        }
        #recipe-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        #recipe-list::-webkit-scrollbar-thumb {
            background: #d1d5db; /* Tailwind gray-300 */
            border-radius: 10px;
        }
        #recipe-list::-webkit-scrollbar-thumb:hover {
            background: #9ca3af; /* Tailwind gray-400 */
        }
        .modal-enter {
            opacity: 0;
            transform: scale(0.9);
        }
        .modal-enter-active {
            opacity: 1;
            transform: scale(1);
            transition: opacity 300ms, transform 300ms;
        }
        .modal-exit {
            opacity: 1;
            transform: scale(1);
        }
        .modal-exit-active {
            opacity: 0;
            transform: scale(0.9);
            transition: opacity 300ms, transform 300ms;
        }
    </style>
</head>
<body class="bg-gray-50">

    <div class="container mx-auto p-4 lg:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl lg:text-5xl font-bold text-gray-800">VeggiPlan Meal Planner</h1>
            <p class="text-gray-600 mt-2">Plan your vegetarian week with delicious Indian, Italian, Mexican, and Gujarati recipes!</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Weekly Planner Section -->
            <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-lg">
                <div class="flex flex-col sm:flex-row justify-between items-center mb-4 gap-4">
                    <h2 class="text-2xl font-bold">Your Weekly Plan</h2>
                    <div class="flex gap-2">
                        <button id="generate-plan-btn" class="bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded-lg transition-transform transform hover:scale-105">✨ Generate Random Plan</button>
                        <button id="clear-plan-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-transform transform hover:scale-105">Clear Plan</button>
                    </div>
                </div>
                <div id="weekly-planner" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4">
                    <!-- Day columns will be generated by JS -->
                </div>
            </div>

            <!-- Recipe Library Section -->
            <div class="lg:col-span-1 bg-white p-6 rounded-2xl shadow-lg">
                <h2 class="text-2xl font-bold mb-4">Recipe Library</h2>
                <div class="flex flex-wrap gap-2 mb-4">
                    <button class="filter-btn bg-emerald-500 text-white px-4 py-2 rounded-full text-sm" data-cuisine="all">All</button>
                    <button class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full text-sm" data-cuisine="Breakfast">Breakfast</button>
                    <button class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full text-sm" data-cuisine="Indian">Indian</button>
                    <button class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full text-sm" data-cuisine="Italian">Italian</button>
                    <button class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full text-sm" data-cuisine="Mexican">Mexican</button>
                    <button class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full text-sm" data-cuisine="Gujarati">Gujarati</button>
                </div>
                <div id="recipe-list" class="space-y-4 max-h-[60vh] overflow-y-auto pr-2">
                    <!-- Recipe cards will be generated by JS -->
                </div>
                <button id="add-recipe-btn" class="w-full mt-4 bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105">+ Add New Recipe</button>
            </div>
        </div>
    </div>

    <!-- Recipe Detail Modal -->
    <div id="recipe-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden">
        <div id="modal-content" class="modal-enter bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
             <!-- Content will be injected by JS -->
        </div>
    </div>

    <!-- Add Recipe Modal -->
    <div id="add-recipe-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden">
        <div class="modal-content transform scale-95 bg-white rounded-2xl shadow-2xl w-full max-w-xl max-h-[90vh] overflow-y-auto">
            <div class="p-4 border-b flex justify-between items-center">
                <h3 class="text-2xl font-bold">Add a New Recipe</h3>
                <button id="add-modal-close-btn" class="text-3xl font-light text-gray-500 hover:text-gray-800">&times;</button>
            </div>
            <form id="add-recipe-form" class="p-6 space-y-4">
                <input type="text" name="name" placeholder="Recipe Name" class="w-full p-3 border rounded-lg" required>
                <select name="cuisine" class="w-full p-3 border rounded-lg" required>
                    <option value="" disabled selected>Select Cuisine</option>
                    <option value="Breakfast">Breakfast</option>
                    <option value="Indian">Indian</option>
                    <option value="Italian">Italian</option>
                    <option value="Mexican">Mexican</option>
                    <option value="Gujarati">Gujarati</option>
                </select>
                <textarea name="description" placeholder="Short description" class="w-full p-3 border rounded-lg" rows="2" required></textarea>
                <div class="grid grid-cols-2 gap-4">
                    <input type="number" name="prepTime" placeholder="Prep time (mins)" class="w-full p-3 border rounded-lg" required>
                    <input type="number" name="cookTime" placeholder="Cook time (mins)" class="w-full p-3 border rounded-lg" required>
                </div>
                <textarea name="ingredients" placeholder="Ingredients (one per line)" class="w-full p-3 border rounded-lg" rows="5" required></textarea>
                <textarea name="instructions" placeholder="Instructions (use '1. Step one...' format)" class="w-full p-3 border rounded-lg" rows="6" required></textarea>
                <button type="submit" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-lg">Save Recipe</button>
            </form>
        </div>
    </div>


<script>
// --- RECIPE DATABASE ---
// All pre-defined recipes are now included directly in this file.
const initialRecipes = [
    {
        id: 1, name: "Paneer Butter Masala", cuisine: "Indian", description: "A rich and creamy dish of paneer (Indian cheese) in a tomato, butter, and cashew sauce.", prepTime: 15, cookTime: 30,
        ingredients: ["250g Paneer", "2 Onions, chopped", "3 Tomatoes, pureed", "1/4 cup Cashews", "1 tbsp Ginger-garlic paste", "1 tsp Turmeric powder", "1 tsp Red chili powder", "1 tsp Garam masala", "2 tbsp Butter", "2 tbsp Fresh cream"],
        instructions: "1. Soak cashews in hot water for 15 mins. Grind to a smooth paste.\n2. Sauté onions in butter until golden. Add ginger-garlic paste and cook for a minute.\n3. Add tomato puree, turmeric, chili powder and cook until oil separates.\n4. Add cashew paste and cook for 5 more minutes.\n5. Add water, garam masala, salt, and paneer cubes. Simmer for 10 minutes.\n6. Stir in fresh cream and serve hot.",
        imageUrl: "https://placehold.co/600x400/f59e0b/ffffff?text=Paneer+Masala"
    },
    {
        id: 2, name: "Vegetable Biryani", cuisine: "Indian", description: "A fragrant and flavorful rice dish with mixed vegetables, spices, and herbs.", prepTime: 20, cookTime: 40,
        ingredients: ["1 cup Basmati rice", "2 cups Mixed vegetables (carrots, peas, beans)", "1 Onion, sliced", "1 Tomato, chopped", "1/2 cup Yogurt", "1 tbsp Biryani masala", "1/2 tsp Turmeric powder", "Mint and Coriander leaves", "Whole spices (bay leaf, cinnamon, cloves)"],
        instructions: "1. Wash and soak rice for 30 minutes.\n2. In a pot, sauté whole spices and onions until golden.\n3. Add vegetables, tomato, and spice powders. Cook for 5 minutes.\n4. Whisk yogurt and add it to the pot. Cook for 2 more minutes.\n5. Layer the partially cooked rice over the vegetable mixture. Top with mint and coriander.\n6. Cover and cook on low heat (dum) for 20 minutes.",
        imageUrl: "https://placehold.co/600x400/10b981/ffffff?text=Veg+Biryani"
    },
    {
        id: 3, name: "Mushroom Risotto", cuisine: "Italian", description: "A creamy and savory Italian rice dish made with Arborio rice, mushrooms, and Parmesan cheese.", prepTime: 10, cookTime: 35,
        ingredients: ["1 cup Arborio rice", "5 cups Vegetable broth, warm", "200g Mushrooms, sliced", "1 Onion, finely chopped", "2 cloves Garlic, minced", "1/2 cup Dry white wine", "1/2 cup grated Parmesan cheese", "2 tbsp Olive oil", "2 tbsp Butter"],
        instructions: "1. In a large pan, sauté onions and garlic in olive oil until soft.\n2. Add mushrooms and cook until they release their water and brown.\n3. Add the Arborio rice and toast for 1 minute.\n4. Pour in the white wine and cook until it's absorbed.\n5. Add the warm vegetable broth one ladle at a time, stirring continuously, waiting for it to be absorbed before adding the next.\n6. Once the rice is creamy and al dente, stir in the butter and Parmesan cheese. Season with salt and pepper.",
        imageUrl: "https://placehold.co/600x400/8b5cf6/ffffff?text=Mushroom+Risotto"
    },
    {
        id: 4, name: "Margherita Pizza", cuisine: "Italian", description: "A classic Neapolitan pizza, made with San Marzano tomatoes, fresh mozzarella, fresh basil, salt, and extra-virgin olive oil.", prepTime: 20, cookTime: 15,
        ingredients: ["1 Pizza dough", "1/2 cup Tomato sauce (San Marzano)", "150g Fresh mozzarella, sliced", "Fresh basil leaves", "2 tbsp Olive oil", "Salt to taste"],
        instructions: "1. Preheat your oven to its highest temperature (around 250°C / 475°F).\n2. Stretch out the pizza dough on a floured surface.\n3. Spread a thin layer of tomato sauce over the dough.\n4. Arrange the mozzarella slices on top.\n5. Drizzle with olive oil and sprinkle with salt.\n6. Bake for 10-15 minutes, until the crust is golden and the cheese is bubbly.\n7. Top with fresh basil leaves before serving.",
        imageUrl: "https://placehold.co/600x400/ef4444/ffffff?text=Margherita+Pizza"
    },
    {
        id: 5, name: "Black Bean Enchiladas", cuisine: "Mexican", description: "Corn tortillas filled with a savory black bean mixture, smothered in red enchilada sauce and melted cheese.", prepTime: 15, cookTime: 25,
        ingredients: ["8 Corn tortillas", "1 can (15 oz) Black beans, rinsed", "1 can (15 oz) Red enchilada sauce", "1 cup Shredded Monterey Jack cheese", "1 small Onion, chopped", "1 tsp Cumin powder", "Optional toppings: sour cream, cilantro, avocado"],
        instructions: "1. Preheat oven to 190°C / 375°F.\n2. In a bowl, mash half the black beans. Mix in the rest of the beans, onion, and cumin.\n3. Warm the tortillas to make them pliable. Spread some enchilada sauce in a baking dish.\n4. Fill each tortilla with the bean mixture, roll it up, and place it seam-side down in the dish.\n5. Pour the remaining enchilada sauce over the tortillas and top with shredded cheese.\n6. Bake for 20-25 minutes, until heated through and the cheese is melted and bubbly.",
        imageUrl: "https://placehold.co/600x400/3b82f6/ffffff?text=Bean+Enchiladas"
    },
    {
        id: 6, name: "Veggie Fajitas", cuisine: "Mexican", description: "A sizzling mix of bell peppers and onions seasoned with classic fajita spices, served with warm tortillas.", prepTime: 15, cookTime: 15,
        ingredients: ["2 Bell peppers (different colors), sliced", "1 large Onion, sliced", "1 tbsp Fajita seasoning", "1 tbsp Oil", "Warm flour or corn tortillas", "Toppings: guacamole, salsa, sour cream"],
        instructions: "1. In a large skillet or cast iron pan, heat oil over medium-high heat.\n2. Add the sliced onions and bell peppers.\n3. Cook, stirring occasionally, until the vegetables are tender-crisp and slightly charred (about 10-12 minutes).\n4. Sprinkle with fajita seasoning and stir to coat everything well.\n5. Cook for another minute.\n6. Serve immediately with warm tortillas and your favorite toppings.",
        imageUrl: "https://placehold.co/600x400/f97316/ffffff?text=Veggie+Fajitas"
    },
    {
        id: 7, name: "Chana Masala", cuisine: "Indian", description: "A popular North Indian curry made with chickpeas, onions, tomatoes, and a blend of spices.", prepTime: 10, cookTime: 25,
        ingredients: ["1 can (15 oz) Chickpeas", "1 Onion, finely chopped", "2 Tomatoes, pureed", "1 tbsp Ginger-garlic paste", "1 tsp Cumin seeds", "1 tsp Coriander powder", "1/2 tsp Turmeric powder", "1 tsp Chana Masala powder"],
        instructions: "1. Heat oil in a pan, add cumin seeds. Once they splutter, add onions and cook until golden.\n2. Add ginger-garlic paste and cook for a minute.\n3. Add tomato puree and all spice powders. Cook until oil separates.\n4. Add the cooked chickpeas, salt, and some water. Simmer for 10 minutes.\n5. Garnish with coriander leaves and serve.",
        imageUrl: "https://placehold.co/600x400/fb923c/ffffff?text=Chana+Masala"
    },
    {
        id: 8, name: "Palak Paneer", cuisine: "Indian", description: "A classic vegetarian dish where paneer is cooked in a smooth and creamy spinach gravy.", prepTime: 15, cookTime: 20,
        ingredients: ["200g Paneer, cubed", "1 large bunch Spinach (Palak)", "1 Onion, chopped", "1 Tomato, chopped", "2 cloves Garlic, minced", "1 inch Ginger", "1/4 cup Cream", "1 tsp Garam Masala"],
        instructions: "1. Blanch spinach leaves in hot water for 2-3 minutes, then plunge into cold water. Puree the spinach.\n2. Sauté onions, ginger, and garlic until translucent. Add tomatoes and cook until soft.\n3. Add the spinach puree, salt, and garam masala. Cook for 5 minutes.\n4. Add paneer cubes and cream. Simmer for another 2-3 minutes.\n5. Serve hot with naan or rice.",
        imageUrl: "https://placehold.co/600x400/22c55e/ffffff?text=Palak+Paneer"
    },
    {
        id: 9, name: "Pasta Primavera", cuisine: "Italian", description: "A delightful pasta dish loaded with fresh spring vegetables in a light cream or olive oil sauce.", prepTime: 15, cookTime: 20,
        ingredients: ["250g Pasta (like Penne or Fettuccine)", "1 cup Mixed spring vegetables (asparagus, peas, broccoli)", "2 cloves Garlic, minced", "1/4 cup Heavy cream", "1/4 cup grated Parmesan cheese", "2 tbsp Olive oil", "Fresh basil"],
        instructions: "1. Cook pasta according to package directions. Drain, reserving some pasta water.\n2. While pasta cooks, sauté garlic in olive oil. Add vegetables and cook until tender-crisp.\n3. Add the cooked pasta to the skillet with vegetables. Stir in heavy cream and Parmesan cheese.\n4. Add a splash of reserved pasta water to create a light sauce. Season with salt and pepper.\n5. Garnish with fresh basil and serve.",
        imageUrl: "https://placehold.co/600x400/a3e635/ffffff?text=Pasta+Primavera"
    },
    {
        id: 10, name: "Caprese Salad Skewers", cuisine: "Italian", description: "A simple and elegant appetizer featuring cherry tomatoes, fresh mozzarella balls, and basil, drizzled with balsamic glaze.", prepTime: 15, cookTime: 0,
        ingredients: ["1 pint Cherry tomatoes", "200g Fresh mozzarella balls (ciliegine)", "Fresh basil leaves", "Balsamic glaze", "Olive oil", "Salt and pepper", "Wooden skewers"],
        instructions: "1. Thread one cherry tomato, one mozzarella ball, and one folded basil leaf onto each skewer.\n2. Repeat until the skewer is full.\n3. Arrange the skewers on a platter.\n4. Drizzle with olive oil and balsamic glaze just before serving.\n5. Sprinkle with a little salt and freshly ground black pepper.",
        imageUrl: "https://placehold.co/600x400/f87171/ffffff?text=Caprese+Skewers"
    },
    {
        id: 11, name: "Veggie Quesadillas", cuisine: "Mexican", description: "A quick and easy meal with tortillas filled with cheese, beans, and sautéed vegetables, grilled until golden.", prepTime: 10, cookTime: 10,
        ingredients: ["4 large Flour tortillas", "2 cups Shredded cheese (Mexican blend)", "1 can (15 oz) Black beans, rinsed", "1 Bell pepper, chopped", "1 small Onion, chopped", "1 tbsp Oil", "Serve with: salsa, sour cream, guacamole"],
        instructions: "1. Sauté the bell pepper and onion in oil until softened.\n2. Lay a tortilla flat. Sprinkle cheese over one half. Top with the sautéed vegetables and black beans.\n3. Sprinkle more cheese on top and fold the other half of the tortilla over.\n4. Cook in a lightly oiled pan or griddle over medium heat for 2-3 minutes per side, until golden brown and the cheese is melted.\n5. Cut into wedges and serve with your favorite dips.",
        imageUrl: "https://placehold.co/600x400/facc15/ffffff?text=Quesadillas"
    },
    {
        id: 12, name: "Spicy Tofu Tacos", cuisine: "Mexican", description: "Flavorful crumbled tofu seasoned with taco spices, serving as a delicious and healthy vegetarian taco filling.", prepTime: 10, cookTime: 15,
        ingredients: ["1 block Firm tofu, pressed and crumbled", "1 tbsp Taco seasoning", "1 tbsp Soy sauce", "1 tbsp Oil", "Taco shells or small tortillas", "Toppings: lettuce, tomato, cheese, salsa"],
        instructions: "1. Heat oil in a skillet over medium-high heat.\n2. Add the crumbled tofu and cook, stirring, until it starts to brown (about 5-7 minutes).\n3. Add the taco seasoning and soy sauce. Stir well to combine and cook for another 5 minutes until the tofu is well-seasoned and slightly crispy.\n4. Serve the tofu filling in taco shells or tortillas with your desired toppings.",
        imageUrl: "https://placehold.co/600x400/c084fc/ffffff?text=Tofu+Tacos"
    },
    {
        id: 13, name: "Aloo Gobi", cuisine: "Indian", description: "A classic vegetarian Indian dish made with potatoes (aloo) and cauliflower (gobi) cooked in a blend of aromatic spices.", prepTime: 15, cookTime: 25,
        ingredients: ["1 medium Cauliflower, cut into florets", "2 large Potatoes, cubed", "1 Onion, chopped", "1 Tomato, chopped", "1 tsp Cumin seeds", "1 tsp Turmeric powder", "1 tsp Coriander powder", "1/2 tsp Ginger paste"],
        instructions: "1. Heat oil in a pan, add cumin seeds. When they sizzle, add the onion and cook until translucent.\n2. Add ginger paste and cook for another minute.\n3. Add the potatoes and cauliflower, turmeric, and coriander powder. Mix well.\n4. Cover and cook on low-medium heat for 15-20 minutes, stirring occasionally, until vegetables are tender.\n5. Add chopped tomato and cook for another 5 minutes. Garnish with fresh cilantro.",
        imageUrl: "https://placehold.co/600x400/fbbf24/ffffff?text=Aloo+Gobi"
    },
    {
        id: 14, name: "Dal Makhani", cuisine: "Indian", description: "A rich, creamy, and flavorful lentil stew made with black lentils (urad dal) and kidney beans (rajma), simmered in a buttery tomato sauce.", prepTime: 10, cookTime: 60,
        ingredients: ["1 cup Black lentils (Urad dal)", "1/4 cup Kidney beans (Rajma)", "1 Onion, finely chopped", "2 Tomatoes, pureed", "2 tbsp Butter", "1 tbsp Ginger-garlic paste", "1/4 cup Cream", "1 tsp Garam masala"],
        instructions: "1. Soak lentils and kidney beans overnight. Pressure cook until very soft.\n2. In a separate pan, melt butter. Sauté onions until golden brown.\n3. Add ginger-garlic paste and tomato puree. Cook until the mixture thickens and oil separates.\n4. Pour this mixture into the cooked lentils. Add salt and garam masala.\n5. Simmer on low heat for at least 30 minutes, mashing slightly.\n6. Stir in cream before serving.",
        imageUrl: "https://placehold.co/600x400/92400e/ffffff?text=Dal+Makhani"
    },
    {
        id: 15, name: "Eggplant Parmesan", cuisine: "Italian", description: "Layers of breaded eggplant slices, rich marinara sauce, mozzarella, and Parmesan cheese, baked to perfection.", prepTime: 20, cookTime: 40,
        ingredients: ["1 large Eggplant, sliced", "1 cup Breadcrumbs", "1/2 cup Grated Parmesan cheese", "2 cups Marinara sauce", "1.5 cups Shredded mozzarella cheese", "1 Egg, beaten", "Olive oil for frying"],
        instructions: "1. Preheat oven to 375°F (190°C).\n2. Dip eggplant slices in beaten egg, then coat with a mixture of breadcrumbs and Parmesan cheese.\n3. Pan-fry the eggplant slices in olive oil until golden brown on both sides. Drain on paper towels.\n4. In a baking dish, spread a layer of marinara sauce. Arrange a layer of eggplant, followed by mozzarella and Parmesan.\n5. Repeat the layers, ending with a final layer of sauce and cheese.\n6. Bake for 25-30 minutes, or until the sauce is bubbly and the cheese is melted and golden.",
        imageUrl: "https://placehold.co/600x400/a855f7/ffffff?text=Eggplant+Parmesan"
    },
    {
        id: 16, name: "Spinach & Ricotta Stuffed Shells", cuisine: "Italian", description: "Jumbo pasta shells filled with a creamy mixture of spinach and ricotta cheese, baked in marinara sauce.", prepTime: 20, cookTime: 30,
        ingredients: ["12 Jumbo pasta shells", "15 oz Ricotta cheese", "1 cup Frozen spinach, thawed and squeezed dry", "1 cup Shredded mozzarella cheese", "1/2 cup Grated Parmesan cheese", "1 Egg", "2 cups Marinara sauce"],
        instructions: "1. Cook pasta shells according to package directions. Drain.\n2. Preheat oven to 375°F (190°C).\n3. In a bowl, mix ricotta, spinach, half of the mozzarella, Parmesan, and the egg. Season with salt and pepper.\n4. Spread a layer of marinara sauce in a baking dish.\n5. Fill each cooked shell with the ricotta mixture and arrange them in the dish.\n6. Top with remaining marinara sauce and mozzarella cheese.\n7. Bake for 20-25 minutes until heated through and bubbly.",
        imageUrl: "https://placehold.co/600x400/ec4899/ffffff?text=Stuffed+Shells"
    },
    {
        id: 17, name: "Vegetarian Chiles Rellenos", cuisine: "Mexican", description: "Roasted poblano peppers stuffed with cheese, dipped in a light egg batter, and fried until golden, often served with a tomato-based sauce.", prepTime: 25, cookTime: 20,
        ingredients: ["4 large Poblano peppers", "1 cup Queso Oaxaca or Monterey Jack cheese, shredded", "2 Eggs, separated", "1/4 cup Flour", "Oil for frying", "Tomato salsa for serving"],
        instructions: "1. Roast the poblano peppers over an open flame or under a broiler until the skin is blistered and blackened all over.\n2. Place them in a bowl and cover for 15 minutes to steam. Then, peel off the skin, make a slit, and carefully remove the seeds.\n3. Stuff each pepper with cheese.\n4. Beat egg whites until stiff peaks form. Gently fold in the egg yolks. Dredge stuffed peppers in flour, then dip into the egg batter.\n5. Fry in hot oil until golden brown on all sides. Drain on paper towels and serve with salsa.",
        imageUrl: "https://placehold.co/600x400/16a34a/ffffff?text=Chiles+Rellenos"
    },
    {
        id: 18, name: "Lentil Walnut Tacos", cuisine: "Mexican", description: "A hearty and nutritious taco filling made from cooked lentils and toasted walnuts, seasoned with classic taco spices.", prepTime: 10, cookTime: 20,
        ingredients: ["1 cup Brown or green lentils, cooked", "1/2 cup Walnuts, toasted and chopped", "1 tbsp Taco seasoning", "1/2 Onion, chopped", "2 cloves Garlic, minced", "Taco shells and desired toppings"],
        instructions: "1. Sauté onion and garlic in a pan until soft.\n2. Add the cooked lentils, chopped walnuts, and taco seasoning. Stir to combine.\n3. Cook for about 5-7 minutes, adding a little water if it becomes too dry, until heated through.\n4. Lightly mash some of the lentils to create a more cohesive filling.\n5. Serve the lentil-walnut mixture in taco shells with your favorite toppings.",
        imageUrl: "https://placehold.co/600x400/ca8a04/ffffff?text=Lentil+Tacos"
    },
    {
        id: 19, name: "Malai Kofta", cuisine: "Indian", description: "Deep-fried balls (kofta) made of potato and paneer are dunked in a rich, creamy, and lightly sweet gravy.", prepTime: 30, cookTime: 30,
        ingredients: ["For Kofta: 2 boiled Potatoes, 100g grated Paneer, 2 tbsp Cornflour", "For Gravy: 2 Onions, 2 Tomatoes, 10 Cashews, 1/4 cup Cream, 1 tsp Ginger-garlic paste"],
        instructions: "1. For kofta, mash potatoes and paneer. Add cornflour, salt, and form into small balls. Deep fry until golden brown.\n2. For gravy, make a paste of onions, and a separate paste of tomatoes and cashews.\n3. Sauté onion paste until golden. Add ginger-garlic paste, then the tomato-cashew paste. Cook until oil separates.\n4. Add spice powders (turmeric, coriander) and cook for a minute.\n5. Add water and simmer for 10 minutes. Stir in cream and garam masala.\n6. Add the fried koftas to the gravy just before serving.",
        imageUrl: "https://placehold.co/600x400/fca5a5/ffffff?text=Malai+Kofta"
    },
    {
        id: 20, name: "Gnocchi with Pesto", cuisine: "Italian", description: "Soft, pillowy potato gnocchi tossed in a vibrant and aromatic basil pesto sauce.", prepTime: 5, cookTime: 10,
        ingredients: ["1 package (500g) Potato gnocchi", "1/2 cup Basil pesto", "1/4 cup Grated Parmesan cheese", "Cherry tomatoes, halved (optional)", "Pine nuts for garnish"],
        instructions: "1. Cook the gnocchi according to package directions (they usually cook in 2-3 minutes and float to the top when done).\n2. Reserve a small amount of the cooking water, then drain the gnocchi.\n3. In a large bowl, toss the hot gnocchi with the basil pesto. Add a tablespoon or two of the reserved pasta water to help the sauce coat the gnocchi evenly.\n4. Stir in the Parmesan cheese and cherry tomatoes (if using).\n5. Serve immediately, garnished with extra Parmesan and pine nuts.",
        imageUrl: "https://placehold.co/600x400/4ade80/ffffff?text=Pesto+Gnocchi"
    },
    {
        id: 21, name: "Homemade Guacamole", cuisine: "Mexican", description: "A classic and essential Mexican dip made from mashed ripe avocados, onion, cilantro, lime juice, and jalapeños.", prepTime: 10, cookTime: 0,
        ingredients: ["3 ripe Avocados", "1/2 small Onion, finely chopped", "1/4 cup fresh Cilantro, chopped", "1 Jalapeño, minced (optional)", "Juice of 1 Lime", "Salt to taste"],
        instructions: "1. Halve the avocados, remove the pits, and scoop the flesh into a medium bowl.\n2. Coarsely mash the avocado with a fork, leaving some chunks for texture.\n3. Add the chopped onion, cilantro, jalapeño (if using), and lime juice.\n4. Stir everything together until well combined.\n5. Season generously with salt. Taste and adjust seasoning if necessary.\n6. Serve immediately with tortilla chips.",
        imageUrl: "https://placehold.co/600x400/84cc16/ffffff?text=Guacamole"
    },
    {
        id: 22, name: "Classic Bruschetta", cuisine: "Italian", description: "Toasted baguette slices topped with a fresh, vibrant mixture of diced tomatoes, garlic, basil, and olive oil.", prepTime: 15, cookTime: 5,
        ingredients: ["1 Baguette, sliced", "4 ripe Roma tomatoes, diced", "2 cloves Garlic, minced", "1/4 cup fresh Basil, chopped", "2 tbsp Olive oil", "Balsamic glaze for drizzling (optional)"],
        instructions: "1. Preheat oven to 375°F (190°C). Arrange baguette slices on a baking sheet and toast for 5-7 minutes until lightly golden.\n2. In a bowl, combine the diced tomatoes, minced garlic, chopped basil, and olive oil. Season with salt and pepper.\n3. Let the tomato mixture sit for about 10 minutes for the flavors to meld.\n4. Spoon the tomato mixture onto the toasted baguette slices.\n5. Drizzle with balsamic glaze just before serving, if desired.",
        imageUrl: "https://placehold.co/600x400/dc2626/ffffff?text=Bruschetta"
    },
    {
        id: 23, name: "Corn & Zucchini Tostadas", cuisine: "Mexican", description: "Crispy corn tortillas topped with refried beans, a fresh sauté of corn and zucchini, and crumbled cheese.", prepTime: 10, cookTime: 15,
        ingredients: ["8 Tostada shells", "1 can (15 oz) Refried beans, heated", "2 Zucchini, diced", "1 cup Corn kernels (fresh or frozen)", "1/2 Onion, chopped", "1 cup Cotija or Feta cheese, crumbled", "1 tbsp Olive oil"],
        instructions: "1. Heat olive oil in a skillet. Sauté the onion until soft, then add the zucchini and corn. Cook until tender-crisp, about 5-7 minutes. Season with salt and pepper.\n2. To assemble, spread a layer of warm refried beans on each tostada shell.\n3. Top with the corn and zucchini mixture.\n4. Sprinkle generously with crumbled cheese.\n5. Serve immediately, with salsa or sour cream on the side.",
        imageUrl: "https://placehold.co/600x400/f59e0b/ffffff?text=Veggie+Tostadas"
    },
    {
        id: 24, name: "Vegetable Samosas", cuisine: "Indian", description: "A popular Indian appetizer consisting of a crispy, fried pastry shell filled with a savory mixture of spiced potatoes and peas.", prepTime: 40, cookTime: 20,
        ingredients: ["For dough: 1 cup All-purpose flour, 2 tbsp oil, water", "For filling: 2 boiled Potatoes, mashed, 1/2 cup green Peas, 1 tsp Cumin seeds, 1 tsp ground Coriander, 1/2 tsp Garam masala", "Oil for deep frying"],
        instructions: "1. For the dough, mix flour, salt, and oil. Gradually add water to form a firm dough. Cover and rest for 30 minutes.\n2. For the filling, heat a little oil, add cumin seeds, then add mashed potatoes, peas, and all the spice powders. Mix well and cook for 5 minutes.\n3. Divide the dough into small balls. Roll each ball into a thin oval, then cut it in half to make two semicircles.\n4. Form a cone shape from a semicircle, fill it with the potato mixture, and seal the edges tightly using a little water.\n5. Deep fry the samosas on low-medium heat until they are golden brown and crispy.",
        imageUrl: "https://placehold.co/600x400/d97706/ffffff?text=Samosas"
    },
    {
        id: 25, name: "Khaman Dhokla", cuisine: "Gujarati", description: "A popular savory, steamed cake made from gram flour, it's soft, fluffy, and spongy.", prepTime: 15, cookTime: 20,
        ingredients: ["1 cup Gram flour (Besan)", "1 tbsp Semolina (Sooji)", "1 tsp Ginger-chili paste", "1 tsp Lemon juice", "1 tsp Eno fruit salt", "For tempering: 1 tbsp Oil, 1 tsp Mustard seeds, Curry leaves, Green chilies", "2 tbsp Sugar", "Coriander for garnish"],
        instructions: "1. Mix gram flour, semolina, ginger-chili paste, lemon juice, sugar, and salt with water to make a smooth batter.\n2. Let it rest for 15 minutes.\n3. Just before steaming, add Eno fruit salt and mix gently.\n4. Pour the batter into a greased steaming pan and steam for 15-20 minutes.\n5. For tempering, heat oil and add mustard seeds, curry leaves, and green chilies. Add a little water and sugar, and bring to a boil.\n6. Pour the tempering over the cooked dhokla. Garnish with coriander and serve.",
        imageUrl: "https://placehold.co/600x400/fcd34d/ffffff?text=Dhokla"
    },
    {
        id: 26, name: "Khandvi", cuisine: "Gujarati", description: "Soft, savory rolls made from gram flour and yogurt, tempered with mustard seeds and garnished with coconut.", prepTime: 10, cookTime: 20,
        ingredients: ["1 cup Gram flour (Besan)", "1 cup Sour yogurt", "2 cups Water", "1 tsp Ginger-chili paste", "1/4 tsp Turmeric powder", "For tempering: 1 tbsp Oil, 1 tsp Mustard seeds, a pinch of Asafoetida (hing)", "Grated coconut and cilantro for garnish"],
        instructions: "1. Whisk gram flour, yogurt, water, ginger-chili paste, turmeric, and salt until there are no lumps.\n2. Cook this mixture in a non-stick pan on low-medium heat, stirring continuously until it becomes very thick.\n3. Quickly spread a thin layer of the hot mixture onto a smooth, greased surface (like the back of a steel plate).\n4. Let it cool for 5-10 minutes. Cut into wide strips and carefully roll them up.\n5. Prepare the tempering by heating oil and adding mustard seeds and asafoetida.\n6. Pour the tempering over the Khandvi rolls. Garnish with grated coconut and cilantro.",
        imageUrl: "https://placehold.co/600x400/fef08a/ffffff?text=Khandvi"
    },
    {
        id: 27, name: "Undhiyu", cuisine: "Gujarati", description: "A classic Gujarati mixed vegetable casserole, traditionally cooked upside down underground in earthen pots.", prepTime: 30, cookTime: 45,
        ingredients: ["1 cup Mixed vegetables (Surti papdi, sweet potatoes, baby potatoes, eggplant)", "1 cup Methi Muthias (fenugreek dumplings)", "1/2 cup Grated coconut", "1/4 cup Peanuts, crushed", "2 tbsp Sesame seeds", "Ginger-garlic-chili paste", "1 tsp Garam masala", "Coriander leaves"],
        instructions: "1. Make a stuffing paste with coconut, peanuts, sesame seeds, ginger-garlic-chili paste, garam masala, and salt.\n2. Stuff the baby potatoes and eggplants with this mixture.\n3. In a pressure cooker, layer the sturdiest vegetables like potatoes and surti papdi at the bottom.\n4. Add the stuffed vegetables and the remaining unstuffed veggies.\n5. Sprinkle the rest of the masala on top. Add methi muthias.\n6. Add a little oil and water, and pressure cook for 2-3 whistles.\n7. Garnish with fresh coriander before serving.",
        imageUrl: "https://placehold.co/600x400/65a30d/ffffff?text=Undhiyu"
    },
    {
        id: 28, name: "Dal Dhokli", cuisine: "Gujarati", description: "A comforting one-pot meal where spiced whole wheat flour dumplings are simmered in a sweet and tangy lentil stew.", prepTime: 20, cookTime: 30,
        ingredients: ["For Dal: 1 cup Pigeon peas (Toor dal), 2 tbsp Peanuts, 1 piece Jaggery", "For Dhokli: 1 cup Whole wheat flour, 1 tsp Red chili powder, 1/4 tsp Turmeric", "For tempering: 1 tbsp Ghee, 1 tsp Mustard seeds, 1 tsp Cumin seeds, Curry leaves, a pinch of Asafoetida (hing)"],
        instructions: "1. Pressure cook the toor dal with peanuts, salt, and turmeric until soft. Whisk until smooth.\n2. Add water to the dal to reach desired consistency. Add jaggery, lemon juice, and red chili powder. Let it simmer.\n3. For dhokli, make a firm dough with wheat flour, spices, a little oil, and water. Roll it thin and cut into diamond shapes.\n4. Drop the dhokli pieces into the simmering dal one by one. Cook for 15 minutes until the dhokli is cooked through.\n5. Prepare tempering with ghee, mustard seeds, cumin seeds, curry leaves, and asafoetida. Pour over the dal dhokli.\n6. Garnish with cilantro and serve hot.",
        imageUrl: "https://placehold.co/600x400/f59e0b/ffffff?text=Dal+Dhokli"
    },
    {
        id: 29, name: "Fluffy Pancakes", cuisine: "Breakfast", description: "Classic, light, and fluffy American-style pancakes, perfect with maple syrup and berries.", prepTime: 10, cookTime: 15,
        ingredients: ["1.5 cups All-purpose flour", "3.5 tsp Baking powder", "1 tsp Salt", "1 tbsp White sugar", "1.25 cups Milk", "1 Egg", "3 tbsp Butter, melted"],
        instructions: "1. In a large bowl, sift together the flour, baking powder, salt, and sugar.\n2. Make a well in the center and pour in the milk, egg, and melted butter; mix until smooth.\n3. Heat a lightly oiled griddle or frying pan over medium-high heat.\n4. Pour or scoop the batter onto the griddle, using approximately 1/4 cup for each pancake.\n5. Brown on both sides and serve hot with your favorite toppings.",
        imageUrl: "https://placehold.co/600x400/7c3aed/ffffff?text=Pancakes"
    },
    {
        id: 30, name: "Buttermilk Biscuits", cuisine: "Breakfast", description: "Warm, flaky, and tender buttermilk biscuits that are perfect for breakfast, served with butter and jam.", prepTime: 15, cookTime: 15,
        ingredients: ["2 cups All-purpose flour", "1 tbsp Baking powder", "1/2 tsp Salt", "1/2 cup Cold butter, cubed", "3/4 cup Buttermilk"],
        instructions: "1. Preheat oven to 425°F (220°C).\n2. In a large bowl, whisk together flour, baking powder, and salt.\n3. Cut in the cold butter using a pastry blender or your fingers until the mixture resembles coarse crumbs.\n4. Stir in the buttermilk until a soft dough forms.\n5. Turn the dough out onto a floured surface and knead briefly 3-4 times. Pat or roll the dough out to 1/2-inch thickness.\n6. Cut out biscuits with a round cutter and place them on an ungreased baking sheet.\n7. Bake for 12-15 minutes, or until golden brown.",
        imageUrl: "https://placehold.co/600x400/ea580c/ffffff?text=Biscuits"
    },
    {
        id: 31, name: "Tofu Scramble", cuisine: "Breakfast", description: "A popular vegan alternative to scrambled eggs, seasoned with nutritional yeast and turmeric for a cheesy, savory flavor and yellow color.", prepTime: 5, cookTime: 10,
        ingredients: ["1 block Firm tofu, pressed", "1 tbsp Olive oil", "1/4 cup Nutritional yeast", "1/2 tsp Turmeric powder", "1/2 tsp Garlic powder", "Salt and black pepper to taste", "Optional: chopped onions, bell peppers, spinach"],
        instructions: "1. Crumble the pressed tofu with your hands into a bowl.\n2. Heat olive oil in a skillet over medium heat. If using veggies, sauté them now until soft.\n3. Add the crumbled tofu to the skillet.\n4. Sprinkle with nutritional yeast, turmeric, garlic powder, salt, and pepper.\n5. Stir and cook for 5-7 minutes until the tofu is heated through and has absorbed the spices.\n6. Serve immediately.",
        imageUrl: "https://placehold.co/600x400/f59e0b/ffffff?text=Tofu+Scramble"
    },
    {
        id: 32, name: "Classic Oatmeal", cuisine: "Breakfast", description: "A simple, healthy, and hearty bowl of oatmeal, easily customizable with your favorite fruits, nuts, and sweeteners.", prepTime: 2, cookTime: 8,
        ingredients: ["1/2 cup Rolled oats", "1 cup Water or milk (or a mix)", "Pinch of salt", "Toppings: Berries, banana slices, walnuts, maple syrup, cinnamon"],
        instructions: "1. In a small saucepan, bring the water or milk to a simmer.\n2. Stir in the rolled oats and a pinch of salt.\n3. Reduce the heat to low and cook for 5-7 minutes, stirring occasionally, until the oats are tender and have absorbed most of the liquid.\n4. Pour the oatmeal into a bowl.\n5. Add your favorite toppings like fresh berries, sliced banana, a sprinkle of cinnamon, and a drizzle of maple syrup.",
        imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Oatmeal"
    },
    {
        id: 33, name: "Thepla", cuisine: "Gujarati", description: "A soft, spiced flatbread made from wheat flour, gram flour, and fenugreek leaves (methi). A travel essential!", prepTime: 20, cookTime: 20,
        ingredients: ["1 cup Whole wheat flour", "1/4 cup Gram flour (Besan)", "1/2 cup chopped Fenugreek leaves (Methi)", "1/4 cup Yogurt", "1 tsp Red chili powder", "1/2 tsp Turmeric powder", "Oil for cooking"],
        instructions: "1. In a bowl, mix all ingredients except oil to form a soft dough. Use a little water if needed.\n2. Let the dough rest for 15 minutes.\n3. Divide the dough into small balls and roll them out into thin circles.\n4. Cook on a hot griddle (tava) on both sides, applying a little oil, until golden brown spots appear.\n5. Serve hot with yogurt, chutney, or pickles.",
        imageUrl: "https://placehold.co/600x400/a16207/ffffff?text=Thepla"
    },
    {
        id: 34, name: "Sev Tameta nu Shaak", cuisine: "Gujarati", description: "A sweet, spicy, and tangy tomato curry topped with a generous amount of crispy gram flour noodles (sev).", prepTime: 10, cookTime: 15,
        ingredients: ["4 large Tomatoes, chopped", "1 cup Sev (thick variety)", "1 tsp Cumin seeds", "1 tsp Ginger-chili paste", "1/2 tsp Turmeric powder", "1 tsp Red chili powder", "1 tbsp Jaggery", "Coriander for garnish"],
        instructions: "1. Heat oil in a pan, add cumin seeds. Once they splutter, add ginger-chili paste.\n2. Add the chopped tomatoes and cook until they become soft and mushy.\n3. Add turmeric, chili powder, jaggery, and salt. Mix well.\n4. Add 1 cup of water and bring the curry to a boil. Let it simmer for 5-7 minutes.\n5. Turn off the heat. Just before serving, add the sev to the curry and garnish with coriander. Serve immediately to keep the sev crispy.",
        imageUrl: "https://placehold.co/600x400/b91c1c/ffffff?text=Sev+Tameta"
    },
    {
        id: 35, name: "Patra", cuisine: "Gujarati", description: "A savory snack made by smearing a spiced gram flour paste on colocasia leaves, which are then rolled, steamed, and pan-fried.", prepTime: 25, cookTime: 30,
        ingredients: ["8-10 Colocasia leaves (Arbi ke patte)", "1.5 cups Gram flour (Besan)", "1/4 cup Jaggery", "2 tbsp Tamarind pulp", "1 tsp Ginger-chili paste", "1 tsp Red chili powder", "For tempering: Oil, mustard seeds, sesame seeds"],
        instructions: "1. Make a thick paste of gram flour, jaggery, tamarind pulp, ginger-chili paste, and spices.\n2. Wash and de-vein the colocasia leaves. Place one leaf upside down and spread a thin layer of the paste.\n3. Place another leaf on top and repeat. Stack about 3-4 leaves.\n4. Fold the sides and roll the stack tightly. Steam the rolls for 20-25 minutes.\n5. Let the rolls cool completely, then slice them into 1/2-inch thick pieces.\n6. For tempering, heat oil and add mustard and sesame seeds. Add the patra slices and pan-fry until crispy.",
        imageUrl: "https://placehold.co/600x400/15803d/ffffff?text=Patra"
    },
    {
        id: 36, name: "Handvo", cuisine: "Gujarati", description: "A savory, baked or pan-fried cake made from a fermented batter of rice and lentils, often with bottle gourd (dudhi).", prepTime: 20, cookTime: 40,
        ingredients: ["1 cup Rice", "1/2 cup mixed Lentils (Toor, Chana)", "1/2 cup grated Bottle Gourd (Dudhi)", "1/4 cup Yogurt", "1 tsp Ginger-chili paste", "1 tsp Eno fruit salt", "For tempering: Oil, mustard seeds, sesame seeds, curry leaves"],
        instructions: "1. Soak rice and lentils for 4-5 hours. Grind to a coarse batter. Let it ferment overnight.\n2. To the fermented batter, add grated bottle gourd, yogurt, ginger-chili paste, sugar, and salt. Mix well.\n3. Heat oil in a pan for tempering. Add mustard seeds, sesame seeds, and curry leaves. Pour half of this into the batter.\n4. Add Eno fruit salt to the batter and mix gently.\n5. Pour the batter into a greased baking pan, top with the remaining tempering, and bake at 350°F (180°C) for 30-40 minutes, or until a toothpick comes out clean.",
        imageUrl: "https://placehold.co/600x400/b45309/ffffff?text=Handvo"
    },
    {
        id: 37, name: "Gujarati Kadhi", cuisine: "Gujarati", description: "A sweet, spicy, and tangy soup-like dish made from yogurt and gram flour, distinct from its North Indian counterpart.", prepTime: 5, cookTime: 15,
        ingredients: ["1 cup Yogurt (slightly sour)", "2 tbsp Gram flour (Besan)", "1 tbsp Ginger-chili paste", "2 tbsp Sugar or Jaggery", "For tempering: 1 tbsp Ghee, 1 tsp Mustard seeds, 1 tsp Cumin seeds, Cinnamon stick, Cloves, Curry leaves"],
        instructions: "1. Whisk yogurt and gram flour together until smooth, ensuring no lumps. Add about 2-3 cups of water.\n2. Add ginger-chili paste, sugar/jaggery, and salt. Mix well.\n3. Bring this mixture to a boil over medium heat, stirring continuously to prevent it from curdling.\n4. Simmer for 10-12 minutes until the kadhi thickens slightly and the raw taste of besan is gone.\n5. For the tempering, heat ghee in a small pan. Add all tempering ingredients and let them splutter. Pour this over the simmering kadhi.\n6. Garnish with fresh coriander and serve hot with rice.",
        imageUrl: "https://placehold.co/600x400/fefce8/000000?text=Gujarati+Kadhi"
    },
    {
        id: 38, name: "Lilva Kachori", cuisine: "Gujarati", description: "A delectable fried pastry filled with a savory mixture of fresh pigeon peas (lilva) and spices.", prepTime: 30, cookTime: 25,
        ingredients: ["For dough: 1 cup All-purpose flour", "For filling: 1 cup fresh Pigeon Peas (Lilva), 1 tbsp Ginger-chili paste, 1 tbsp Sugar, 1 tsp Lemon juice, Garam masala", "Oil for deep frying"],
        instructions: "1. Make a firm dough with flour, a little oil, salt, and water. Rest for 20 minutes.\n2. Coarsely grind the fresh pigeon peas. In a pan, sauté the ground peas with ginger-chili paste and spices. Add sugar and lemon juice. Let it cool.\n3. Make small balls from the dough and roll them into small circles.\n4. Place a spoonful of the filling in the center, bring the edges together, and seal to form a ball.\n5. Deep fry the kachoris on low-medium heat until they are golden brown and crisp.",
        imageUrl: "https://placehold.co/600x400/84cc16/ffffff?text=Lilva+Kachori"
    },
    {
        id: 39, name: "Mohanthal", cuisine: "Gujarati", description: "A traditional, dense, fudgy sweet made from roasted gram flour (besan), ghee, sugar, and flavored with cardamom and nuts.", prepTime: 10, cookTime: 40,
        ingredients: ["2 cups Gram flour (Besan)", "1.5 cups Ghee", "1.5 cups Sugar", "1 cup Milk", "1 tsp Cardamom powder", "Sliced almonds and pistachios for garnish"],
        instructions: "1. In a heavy-bottomed pan, roast the gram flour in ghee on low heat, stirring continuously, until it turns golden brown and aromatic (about 25-30 mins).\n2. In a separate pan, prepare a sugar syrup of one-string consistency by boiling sugar and water.\n3. Pour the hot sugar syrup into the roasted besan mixture. Stir vigorously to avoid lumps.\n4. Add milk and cardamom powder. Cook for another 5-7 minutes until the mixture thickens and leaves the sides of the pan.\n5. Pour the mixture into a greased tray. Garnish with nuts and let it set for a few hours. Cut into squares.",
        imageUrl: "https://placehold.co/600x400/f9a8d4/ffffff?text=Mohanthal"
    },
    {
        id: 40, name: "Basundi", cuisine: "Gujarati", description: "A rich, creamy, and sweet dessert made by slowly simmering and reducing milk until it thickens, flavored with cardamom and nuts.", prepTime: 5, cookTime: 50,
        ingredients: ["1 liter Full-fat milk", "1/2 cup Sugar", "1/2 tsp Cardamom powder", "A few strands of Saffron", "Chopped almonds and pistachios"],
        instructions: "1. In a heavy, wide pan, bring the milk to a boil.\n2. Reduce the heat to medium-low and simmer, stirring every few minutes to prevent it from sticking to the bottom.\n3. Scrape the cream that forms on the sides and stir it back into the milk. This makes the basundi thick and rich.\n4. Continue to simmer until the milk is reduced to about half its original volume.\n5. Add sugar, cardamom powder, and saffron. Stir until the sugar dissolves.\n6. Cook for another 5 minutes. Garnish with chopped nuts. Serve chilled or warm.",
        imageUrl: "https://placehold.co/600x400/fed7aa/000000?text=Basundi"
    },
    {
        id: 41, name: "Pudla (Savory Pancakes)", cuisine: "Gujarati", description: "Quick and savory pancakes made from a gram flour batter, often mixed with chopped vegetables and spices.", prepTime: 10, cookTime: 15,
        ingredients: ["1 cup Gram flour (Besan)", "1/4 cup finely chopped Onion", "1/4 cup finely chopped Tomato", "1 Green chili, minced", "1/4 tsp Turmeric powder", "A pinch of Asafoetida (hing)", "Oil for cooking"],
        instructions: "1. In a bowl, whisk gram flour with water to make a smooth, lump-free batter of pouring consistency.\n2. Add all the chopped vegetables, chili, turmeric, asafoetida, and salt. Mix well.\n3. Heat a non-stick pan or griddle and lightly grease it with oil.\n4. Pour a ladleful of batter and spread it in a circular motion to form a pancake.\n5. Drizzle a little oil around the edges and cook for 2-3 minutes on each side, until golden brown and crisp.\n6. Serve hot with chutney or ketchup.",
        imageUrl: "https://placehold.co/600x400/fcd34d/ffffff?text=Pudla"
    },
    {
        id: 42, name: "Dabeli", cuisine: "Gujarati", description: "A popular street food where a sweet and spicy potato mixture is stuffed into a pav (burger bun) and garnished with sev, pomegranate, and roasted peanuts.", prepTime: 20, cookTime: 15,
        ingredients: ["4 Pav buns", "2 boiled Potatoes, mashed", "2 tbsp Dabeli masala", "1 tbsp Tamarind chutney", "For garnish: Nylon sev, roasted peanuts, pomegranate seeds, chopped onion"],
        instructions: "1. Heat a little oil and sauté the dabeli masala for a minute. Add the mashed potatoes, tamarind chutney, and a little water. Mix well and cook for 5 minutes.\n2. Slit the pav buns horizontally, leaving one side intact.\n3. Apply tamarind chutney on one inner side and garlic chutney (optional) on the other.\n4. Fill the buns with a generous amount of the potato mixture.\n5. Garnish the filling with roasted peanuts, pomegranate seeds, and chopped onion.\n6. Press fine sev on all open sides. Lightly toast the stuffed pav on a hot griddle with butter and serve immediately.",
        imageUrl: "https://placehold.co/600x400/fb7185/ffffff?text=Dabeli"
    },
    {
        id: 43, name: "Rotlo", cuisine: "Gujarati", description: "A traditional flatbread made from millet flour (bajra), typically cooked on a clay griddle and served with ghee and jaggery.", prepTime: 10, cookTime: 15,
        ingredients: ["1 cup Millet flour (Bajra)", "Warm water as needed", "Salt to taste", "Ghee for serving"],
        instructions: "1. In a bowl, mix millet flour and salt. Gradually add warm water and knead to form a smooth, soft dough.\n2. Divide the dough into equal portions.\n3. Take one portion and flatten it between your palms, gently patting and pressing to form a round, flat circle (about 5-6 inches in diameter).\n4. Cook the rotlo on a hot clay or cast-iron griddle on medium heat.\n5. Flip it when one side is partially cooked. Cook the other side, then place it directly on a low flame using tongs. It will puff up.\n6. Serve immediately with a generous dollop of ghee, jaggery, and garlic chutney.",
        imageUrl: "https://placehold.co/600x400/a17a4d/ffffff?text=Rotlo"
    },
    {
        id: 44, name: "Fafda", cuisine: "Gujarati", description: "A crunchy, fried snack made from gram flour, typically enjoyed for breakfast with a side of fried green chilies and papaya chutney (sambharo).", prepTime: 15, cookTime: 20,
        ingredients: ["1 cup Gram flour (Besan)", "1/4 tsp Baking soda", "A pinch of Asafoetida (hing)", "1 tbsp Oil", "Salt and pepper to taste", "Oil for deep frying"],
        instructions: "1. Make a firm dough by mixing gram flour, baking soda, asafoetida, oil, salt, pepper, and just enough water.\n2. Knead the dough well for 5-7 minutes until it is smooth and pliable.\n3. Take a small portion of the dough and place it on a greased wooden board.\n4. Using the base of your palm, press and drag the dough in a straight line to form a long, thin strip.\n5. Carefully lift the strip with a thin knife and deep fry in hot oil until it is light yellow and crisp.\n6. Serve immediately with fried chilies and papaya chutney.",
        imageUrl: "https://placehold.co/600x400/fde047/000000?text=Fafda"
    }
    {
    id: 45, name: "Caprese Salad", cuisine: "Italian", description: "A classic fresh salad of ripe tomatoes, creamy mozzarella, and fragrant basil drizzled with extra virgin olive oil and balsamic glaze.", prepTime: 10, cookTime: 0,
    ingredients: ["4 ripe tomatoes", "8 oz fresh mozzarella", "1 cup fresh basil leaves", "2 tbsp extra virgin olive oil", "1 tbsp balsamic glaze", "Salt and pepper to taste"],
    instructions: "1. Slice tomatoes and mozzarella into 1/4-inch rounds.\n2. Arrange alternating tomato and mozzarella slices on a platter, tucking basil leaves between them.\n3. Drizzle with olive oil and balsamic glaze.\n4. Sprinkle with salt and pepper. Serve immediately.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Caprese+Salad"
},
{
    id: 46, name: "Margherita Pizza", cuisine: "Italian", description: "A simple yet flavorful pizza with a thin crust, fresh tomato sauce, mozzarella, and basil leaves.", prepTime: 20, cookTime: 12,
    ingredients: ["1 pizza dough", "1/2 cup tomato sauce", "8 oz fresh mozzarella", "Fresh basil leaves", "2 tbsp olive oil", "Pinch of salt"],
    instructions: "1. Preheat oven to 500°F (260°C).\n2. Roll out pizza dough and place on a baking sheet or stone.\n3. Spread tomato sauce evenly.\n4. Top with sliced mozzarella and drizzle with olive oil.\n5. Bake 10-12 minutes until crust is golden.\n6. Add fresh basil leaves before serving.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Margherita+Pizza"
},
{
    id: 47, name: "Eggplant Parmigiana", cuisine: "Italian", description: "Layers of crispy baked eggplant slices, marinara sauce, and melted cheese for a comforting vegetarian main dish.", prepTime: 30, cookTime: 45,
    ingredients: ["2 large eggplants", "2 cups marinara sauce", "2 cups shredded mozzarella", "1/2 cup grated Parmesan", "1 cup breadcrumbs", "2 eggs", "Salt, pepper, olive oil"],
    instructions: "1. Preheat oven to 375°F (190°C).\n2. Slice eggplant into 1/2-inch rounds and salt them; let sit 20 min.\n3. Dip slices in beaten eggs, then breadcrumbs.\n4. Bake on a sheet for 20 min, flipping halfway.\n5. Layer eggplant, marinara, and cheese in a baking dish.\n6. Bake 25 min until bubbling and golden.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Eggplant+Parmigiana"
},
{
    id: 48, name: "Pasta Primavera", cuisine: "Italian", description: "A colorful pasta dish packed with seasonal vegetables and tossed in olive oil and garlic.", prepTime: 15, cookTime: 20,
    ingredients: ["12 oz penne pasta", "1 zucchini", "1 red bell pepper", "1 cup cherry tomatoes", "1 cup broccoli florets", "3 cloves garlic", "3 tbsp olive oil", "Salt, pepper, Parmesan"],
    instructions: "1. Cook pasta until al dente.\n2. Sauté garlic in olive oil.\n3. Add chopped vegetables; cook until tender-crisp.\n4. Toss pasta with vegetables, season, and sprinkle with Parmesan.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Pasta+Primavera"
},
{
    id: 49, name: "Spinach and Ricotta Stuffed Shells", cuisine: "Italian", description: "Jumbo pasta shells filled with a creamy spinach-ricotta mixture baked in marinara sauce.", prepTime: 25, cookTime: 35,
    ingredients: ["20 jumbo pasta shells", "2 cups ricotta cheese", "1 cup chopped spinach", "1/2 cup grated Parmesan", "1 egg", "2 cups marinara sauce", "1 cup shredded mozzarella"],
    instructions: "1. Preheat oven to 375°F (190°C).\n2. Cook shells al dente.\n3. Mix ricotta, spinach, Parmesan, and egg.\n4. Fill shells and place in a baking dish with marinara sauce.\n5. Top with mozzarella and bake 30-35 min.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Stuffed+Shells"
},
{
    id: 50, name: "Minestrone Soup", cuisine: "Italian", description: "A hearty vegetable soup with beans and pasta in a savory tomato broth.", prepTime: 15, cookTime: 40,
    ingredients: ["1 onion", "2 carrots", "2 celery stalks", "2 cups chopped tomatoes", "1 zucchini", "1 cup green beans", "1 cup small pasta", "4 cups vegetable broth", "1 can cannellini beans", "Olive oil, salt, pepper"],
    instructions: "1. Sauté onion, carrot, and celery in olive oil.\n2. Add tomatoes and broth, simmer 20 min.\n3. Stir in beans, zucchini, green beans, and pasta.\n4. Cook until pasta is tender. Season to taste.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Minestrone"
},
{
    id: 51, name: "Risotto ai Funghi", cuisine: "Italian", description: "Creamy Arborio rice slow-cooked with mushrooms, vegetable broth, and Parmesan.", prepTime: 15, cookTime: 35,
    ingredients: ["1 1/2 cups Arborio rice", "4 cups vegetable broth", "2 cups sliced mushrooms", "1 onion", "1/2 cup white wine", "1/2 cup grated Parmesan", "2 tbsp butter", "Olive oil, salt, pepper"],
    instructions: "1. Sauté onion and mushrooms in olive oil.\n2. Add rice; toast for 1-2 min.\n3. Deglaze with wine.\n4. Gradually add warm broth, stirring until absorbed each time.\n5. Finish with butter and Parmesan.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Mushroom+Risotto"
},
{
    id: 52, name: "Pasta Puttanesca", cuisine: "Italian", description: "Spaghetti in a bold sauce of tomatoes, olives, capers, garlic, and chili flakes.", prepTime: 10, cookTime: 20,
    ingredients: ["12 oz spaghetti", "2 cups crushed tomatoes", "1/2 cup black olives", "2 tbsp capers", "3 cloves garlic", "1/2 tsp chili flakes", "2 tbsp olive oil", "Salt, pepper"],
    instructions: "1. Cook pasta until al dente.\n2. Sauté garlic and chili flakes in olive oil.\n3. Add tomatoes, olives, and capers; simmer 10 min.\n4. Toss pasta with sauce and serve.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Pasta+Puttanesca"
},
{
    id: 53, name: "Gnocchi with Sage Butter", cuisine: "Italian", description: "Soft potato gnocchi sautéed in browned butter and fresh sage leaves.", prepTime: 10, cookTime: 15,
    ingredients: ["1 lb potato gnocchi", "4 tbsp butter", "10 fresh sage leaves", "1/4 cup grated Parmesan", "Salt, pepper"],
    instructions: "1. Cook gnocchi until they float.\n2. Brown butter with sage leaves in a skillet.\n3. Toss gnocchi in sage butter and sprinkle with Parmesan.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Gnocchi+Sage+Butter"
},
{
    id: 54, name: "Pasta e Fagioli", cuisine: "Italian", description: "A rustic soup of pasta and beans simmered in tomato broth with vegetables.", prepTime: 15, cookTime: 40,
    ingredients: ["1 onion", "2 carrots", "2 celery stalks", "1 can cannellini beans", "1 cup small pasta", "3 cups vegetable broth", "2 cups crushed tomatoes", "Olive oil, salt, pepper"],
    instructions: "1. Sauté onion, carrots, and celery.\n2. Add tomatoes and broth, simmer 20 min.\n3. Add beans and pasta; cook until pasta is tender.\n4. Season with salt and pepper.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Pasta+e+Fagioli"
},
{
    id: 55, name: "Frittata di Verdure", cuisine: "Italian", description: "A fluffy Italian-style omelet packed with seasonal vegetables and cheese.", prepTime: 10, cookTime: 20,
    ingredients: ["6 eggs", "1 cup diced zucchini", "1 cup spinach", "1/2 cup diced onion", "1/2 cup grated Parmesan", "Olive oil, salt, pepper"],
    instructions: "1. Beat eggs with Parmesan, salt, and pepper.\n2. Sauté vegetables in olive oil.\n3. Pour eggs over vegetables and cook on low until set.\n4. Finish under broiler for 2 min if desired.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Vegetable+Frittata"
},
{
    id: 56, name: "Caponata", cuisine: "Italian", description: "A sweet-and-sour Sicilian eggplant relish with tomatoes, capers, and olives.", prepTime: 15, cookTime: 40,
    ingredients: ["2 large eggplants", "1 onion", "2 cups diced tomatoes", "1/4 cup capers", "1/2 cup green olives", "3 tbsp red wine vinegar", "2 tbsp sugar", "Olive oil, salt, pepper"],
    instructions: "1. Cube eggplants and sauté until golden.\n2. Sauté onion; add tomatoes, capers, olives, vinegar, and sugar.\n3. Combine with eggplant and simmer 15 min.\n4. Serve warm or chilled.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Caponata"
},
{
    id: 57, name: "Pesto Genovese Pasta", cuisine: "Italian", description: "Classic Ligurian pasta coated with fresh basil pesto, Parmesan, and pine nuts.", prepTime: 15, cookTime: 10,
    ingredients: ["12 oz trofie or spaghetti", "2 cups fresh basil", "1/4 cup pine nuts", "1/2 cup grated Parmesan", "2 cloves garlic", "1/2 cup olive oil", "Salt"],
    instructions: "1. Cook pasta until al dente.\n2. Blend basil, pine nuts, Parmesan, garlic, and olive oil into pesto.\n3. Toss pasta with pesto and serve.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Pesto+Pasta"
},
{
    id: 58, name: "Polenta with Roasted Vegetables", cuisine: "Italian", description: "Creamy polenta served with a medley of oven-roasted seasonal vegetables.", prepTime: 15, cookTime: 40,
    ingredients: ["1 cup polenta (cornmeal)", "4 cups vegetable broth", "2 tbsp butter", "1/2 cup grated Parmesan", "2 cups assorted vegetables (zucchini, peppers, mushrooms)", "Olive oil, salt, pepper"],
    instructions: "1. Roast vegetables at 400°F (200°C) with olive oil and salt until tender.\n2. Cook polenta in simmering broth, stirring until thick.\n3. Stir in butter and Parmesan.\n4. Serve polenta topped with roasted vegetables.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Polenta+Veggies"
},
{
    id: 59, name: "Bruschetta al Pomodoro", cuisine: "Italian", description: "Grilled bread topped with fresh tomatoes, basil, garlic, and olive oil for a classic antipasto.", prepTime: 10, cookTime: 5,
    ingredients: ["1 baguette", "4 ripe tomatoes", "2 cloves garlic", "1/4 cup fresh basil", "3 tbsp olive oil", "Salt, pepper"],
    instructions: "1. Dice tomatoes and mix with chopped basil, minced garlic, olive oil, salt, and pepper.\n2. Slice baguette and toast until golden.\n3. Spoon tomato mixture over warm bread and serve.",
    imageUrl: "https://placehold.co/600x400/64748b/ffffff?text=Bruschetta+al+Pomodoro"
}
];

document.addEventListener('DOMContentLoaded', () => {
    // Combine initial recipes with recipes from local storage
    let allRecipes = [...initialRecipes, ...loadRecipesFromLocalStorage()];

    const recipeList = document.getElementById('recipe-list');
    const weeklyPlanner = document.getElementById('weekly-planner');
    const filterBtns = document.querySelectorAll('.filter-btn');
    const generatePlanBtn = document.getElementById('generate-plan-btn');
    const clearPlanBtn = document.getElementById('clear-plan-btn');
    
    // Modals
    const recipeModal = document.getElementById('recipe-modal');
    const modalContent = document.getElementById('modal-content');
    const addRecipeModal = document.getElementById('add-recipe-modal');
    const addRecipeBtn = document.getElementById('add-recipe-btn');
    const addModalCloseBtn = document.getElementById('add-modal-close-btn');
    const addRecipeForm = document.getElementById('add-recipe-form');

    const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
    let weeklyPlan = loadPlanFromLocalStorage() || {};

    function saveRecipesToLocalStorage(recipes) {
        const userRecipes = recipes.filter(r => r.id > 1000); // Only save user-added recipes
        localStorage.setItem('mealPlannerUserRecipes', JSON.stringify(userRecipes));
    }

    function loadRecipesFromLocalStorage() {
        return JSON.parse(localStorage.getItem('mealPlannerUserRecipes')) || [];
    }

    function savePlanToLocalStorage() {
        localStorage.setItem('mealPlannerPlan', JSON.stringify(weeklyPlan));
    }

    function loadPlanFromLocalStorage() {
        return JSON.parse(localStorage.getItem('mealPlannerPlan'));
    }

    function renderRecipes(filter = 'all') {
        recipeList.innerHTML = '';
        const filteredRecipes = filter === 'all' ? allRecipes : allRecipes.filter(recipe => recipe.cuisine === filter);
        
        filteredRecipes.forEach(recipe => {
            const recipeCard = document.createElement('div');
            recipeCard.className = 'p-4 border rounded-lg flex gap-4 items-center bg-white shadow-sm cursor-grab active:cursor-grabbing';
            recipeCard.setAttribute('draggable', 'true');
            recipeCard.dataset.recipeId = recipe.id;
            
            recipeCard.innerHTML = `
                <img src="${recipe.imageUrl || 'https://placehold.co/80x80/e2e8f0/cbd5e0?text=Food'}" alt="${recipe.name}" class="w-20 h-20 rounded-md object-cover">
                <div class="flex-1">
                    <h3 class="font-bold text-gray-800">${recipe.name}</h3>
                    <p class="text-sm text-gray-500">${recipe.cuisine}</p>
                </div>
                <button class="view-btn bg-gray-200 text-gray-700 hover:bg-gray-300 px-3 py-1 rounded-md text-sm" data-recipe-id="${recipe.id}">View</button>
            `;
            recipeList.appendChild(recipeCard);
        });
    }

    function renderPlanner() {
        weeklyPlanner.innerHTML = '';
        days.forEach(day => {
            const dayCol = document.createElement('div');
            dayCol.className = 'bg-gray-100 p-3 rounded-lg flex flex-col gap-4';
            dayCol.innerHTML = `<h3 class="font-bold text-center">${day}</h3>`;

            ['Lunch', 'Dinner'].forEach(meal => {
                const mealSlotId = `${day}-${meal}`;
                const recipeId = weeklyPlan[mealSlotId];
                const recipe = recipeId ? allRecipes.find(r => r.id == recipeId) : null;
                
                const mealSlot = document.createElement('div');
                mealSlot.className = 'meal-slot bg-white p-2 rounded-lg min-h-[80px] flex flex-col justify-center items-center text-center transition-all duration-200';
                mealSlot.dataset.slotId = mealSlotId;

                if (recipe) {
                    mealSlot.innerHTML = `
                        <p class="text-sm font-semibold">${recipe.name}</p>
                        <p class="text-xs text-gray-500">${meal}</p>
                        <button class="remove-btn text-red-500 text-xs mt-1" data-slot-id="${mealSlotId}">Remove</button>
                    `;
                } else {
                    mealSlot.innerHTML = `<span class="text-gray-400 text-sm">${meal}</span>`;
                }
                dayCol.appendChild(mealSlot);
            });
            weeklyPlanner.appendChild(dayCol);
        });
    }
    
    function showRecipeModal(recipeId) {
        const recipe = allRecipes.find(r => r.id == recipeId);
        if (!recipe) return;

        modalContent.innerHTML = `
            <div class="p-6">
                <div class="flex justify-between items-start">
                    <h2 class="text-3xl font-bold mb-4">${recipe.name}</h2>
                    <button id="modal-close-btn" class="text-3xl font-light text-gray-500 hover:text-gray-800">&times;</button>
                </div>
                <img src="${recipe.imageUrl || 'https://placehold.co/600x400/e2e8f0/cbd5e0?text=Food'}" alt="${recipe.name}" class="w-full h-64 object-cover rounded-lg mb-4">
                <p class="text-gray-600 mb-4">${recipe.description}</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 text-center">
                    <div class="bg-gray-100 p-2 rounded-lg"><strong>Cuisine:</strong> ${recipe.cuisine}</div>
                    <div class="bg-gray-100 p-2 rounded-lg"><strong>Prep Time:</strong> ${recipe.prepTime} mins</div>
                    <div class="bg-gray-100 p-2 rounded-lg"><strong>Cook Time:</strong> ${recipe.cookTime} mins</div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-xl font-semibold mb-2 border-b pb-1">Ingredients</h3>
                        <ul class="list-disc list-inside space-y-1 text-gray-700">
                            ${recipe.ingredients.map(ing => `<li>${ing}</li>`).join('')}
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold mb-2 border-b pb-1">Instructions</h3>
                        <div class="space-y-2 text-gray-700 whitespace-pre-line">${recipe.instructions}</div>
                    </div>
                </div>
            </div>
        `;
        recipeModal.classList.remove('hidden');
        setTimeout(() => modalContent.classList.add('modal-enter-active'), 10);
        document.getElementById('modal-close-btn').addEventListener('click', closeRecipeModal);
    }
    
    function closeRecipeModal() {
        modalContent.classList.remove('modal-enter-active');
        modalContent.classList.add('modal-exit-active');
        setTimeout(() => {
            recipeModal.classList.add('hidden');
            modalContent.classList.remove('modal-exit-active');
        }, 300);
    }

    function handleFilterClick(e) {
        filterBtns.forEach(btn => {
            btn.classList.remove('bg-emerald-500', 'text-white');
            btn.classList.add('bg-gray-200', 'text-gray-700');
        });
        e.target.classList.add('bg-emerald-500', 'text-white');
        e.target.classList.remove('bg-gray-200', 'text-gray-700');
        renderRecipes(e.target.dataset.cuisine);
    }

    function generateRandomPlan() {
        if (allRecipes.length === 0) {
            alert("There are no recipes to generate a plan from. Please add some recipes first!");
            return;
        }
        weeklyPlan = {};
        days.forEach(day => {
            ['Lunch', 'Dinner'].forEach(meal => {
                const randomRecipe = allRecipes[Math.floor(Math.random() * allRecipes.length)];
                weeklyPlan[`${day}-${meal}`] = randomRecipe.id;
            });
        });
        renderPlanner();
        savePlanToLocalStorage();
    }
    
    // Event Listeners
    filterBtns.forEach(btn => btn.addEventListener('click', handleFilterClick));
    generatePlanBtn.addEventListener('click', generateRandomPlan);
    clearPlanBtn.addEventListener('click', () => {
        weeklyPlan = {};
        renderPlanner();
        savePlanToLocalStorage();
    });

    recipeList.addEventListener('click', (e) => {
        if (e.target.classList.contains('view-btn')) {
            showRecipeModal(e.target.dataset.recipeId);
        }
    });

    recipeModal.addEventListener('click', (e) => {
        if (e.target === recipeModal) {
            closeRecipeModal();
        }
    });

    weeklyPlanner.addEventListener('click', (e) => {
        if (e.target.classList.contains('remove-btn')) {
            delete weeklyPlan[e.target.dataset.slotId];
            renderPlanner();
            savePlanToLocalStorage();
        }
    });

    // Drag and Drop Logic
    let draggedItemId = null;

    recipeList.addEventListener('dragstart', (e) => {
        if (e.target.dataset.recipeId) {
            draggedItemId = e.target.dataset.recipeId;
            e.target.classList.add('dragging');
        }
    });

    recipeList.addEventListener('dragend', (e) => {
        if (e.target.dataset.recipeId) {
            draggedItemId = null;
            e.target.classList.remove('dragging');
        }
    });
    
    weeklyPlanner.addEventListener('dragover', (e) => {
        e.preventDefault();
        const slot = e.target.closest('.meal-slot');
        if (slot) {
            slot.classList.add('drag-over');
        }
    });
    
    weeklyPlanner.addEventListener('dragleave', (e) => {
        const slot = e.target.closest('.meal-slot');
        if (slot) {
            slot.classList.remove('drag-over');
        }
    });

    weeklyPlanner.addEventListener('drop', (e) => {
        e.preventDefault();
        const slot = e.target.closest('.meal-slot');
        if (slot && draggedItemId) {
            slot.classList.remove('drag-over');
            weeklyPlan[slot.dataset.slotId] = draggedItemId;
            renderPlanner();
            savePlanToLocalStorage();
        }
    });
    
    // Add recipe modal logic
    addRecipeBtn.addEventListener('click', () => {
        addRecipeForm.reset();
        addRecipeModal.classList.remove('hidden');
    });

    addModalCloseBtn.addEventListener('click', () => {
        addRecipeModal.classList.add('hidden');
    });

    addRecipeModal.addEventListener('click', (e) => {
        if (e.target === addRecipeModal) {
            addRecipeModal.classList.add('hidden');
        }
    });
    
    addRecipeForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const formData = new FormData(e.target);
        const newRecipe = {
            id: Date.now(), // Simple unique ID
            name: formData.get('name'),
            cuisine: formData.get('cuisine'),
            description: formData.get('description'),
            prepTime: parseInt(formData.get('prepTime')),
            cookTime: parseInt(formData.get('cookTime')),
            ingredients: formData.get('ingredients').split('\n').filter(i => i.trim() !== ''),
            instructions: formData.get('instructions'),
            imageUrl: `https://placehold.co/600x400/8b5cf6/ffffff?text=${formData.get('name').replace(/\s/g, '+')}`
        };
        
        allRecipes.push(newRecipe);
        saveRecipesToLocalStorage(allRecipes);
        renderRecipes(document.querySelector('.filter-btn.bg-emerald-500').dataset.cuisine);
        addRecipeModal.classList.add('hidden');
    });


    // Initial render
    renderRecipes();
    renderPlanner();
});
</script>

</body>
</html>

